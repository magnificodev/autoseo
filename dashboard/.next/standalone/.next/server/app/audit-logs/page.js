(()=>{var e={};e.id=331,e.ids=[331],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5575:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),a(9465),a(3119),a(5866);var r=a(3191),s=a(8716),i=a(7922),n=a.n(i),l=a(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let d=["",{children:["audit-logs",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,9465)),"D:\\Workspace\\beesmart\\autoseo\\dashboard\\app\\audit-logs\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,3119)),"D:\\Workspace\\beesmart\\autoseo\\dashboard\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],c=["D:\\Workspace\\beesmart\\autoseo\\dashboard\\app\\audit-logs\\page.tsx"],u="/audit-logs/page",p={require:a,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/audit-logs/page",pathname:"/audit-logs",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7526:(e,t,a)=>{Promise.resolve().then(a.bind(a,7175))},7175:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(326),s=a(7577),i=a(567),n=a(772),l=a(4432),o=a(5304),d=a(5940);let c={approve:{variant:"default",label:"Duyệt"},reject:{variant:"destructive",label:"Từ chối"},publish:{variant:"outline",label:"Xuất bản"},create:{variant:"secondary",label:"Tạo mới"},update:{variant:"secondary",label:"Cập nhật"},delete:{variant:"destructive",label:"X\xf3a"}};function u(){let[e,t]=(0,s.useState)([]),[a,u]=(0,s.useState)(null),[p,x]=(0,s.useState)(""),[m,h]=(0,s.useState)(""),[g,f]=(0,s.useState)(""),[b,j]=(0,s.useState)(!1),[v,y]=(0,s.useState)(!1);async function w(e){if((e.headers.get("content-type")||"").includes("application/json"))return e.json();throw Error((await e.text()).slice(0,300))}async function _(){try{y(!0),u(null);let e=new URLSearchParams;e.set("limit","200"),p.trim()&&e.set("action",p.trim()),m.trim()&&e.set("start",m.trim()),g.trim()&&e.set("end",g.trim());let a=await fetch(`/api/audit-logs/?${e.toString()}`,{credentials:"include"});if(!a.ok)throw Error(await a.text());let r=await w(a);t(r)}catch(e){u(e.message||"Error")}finally{y(!1)}}return(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("h1",{className:"text-2xl font-bold",children:"Audit Logs"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),_()},className:"flex items-center gap-2 flex-wrap",children:[(0,r.jsxs)("select",{value:p,onChange:e=>x(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[r.jsx("option",{value:"",children:"Tất cả h\xe0nh động"}),r.jsx("option",{value:"approve",children:"Duyệt"}),r.jsx("option",{value:"reject",children:"Từ chối"}),r.jsx("option",{value:"publish",children:"Xuất bản"}),r.jsx("option",{value:"create",children:"Tạo mới"}),r.jsx("option",{value:"update",children:"Cập nhật"}),r.jsx("option",{value:"delete",children:"X\xf3a"})]}),r.jsx(l.I,{type:"datetime-local",value:m,onChange:e=>h(e.target.value),placeholder:"Từ ng\xe0y"}),r.jsx(l.I,{type:"datetime-local",value:g,onChange:e=>f(e.target.value),placeholder:"Đến ng\xe0y"}),r.jsx(n.z,{type:"submit",disabled:v,children:v?"Đang tải...":"Lọc"}),r.jsx(n.z,{type:"button",variant:"secondary",disabled:b,onClick:async()=>{try{j(!0);let e=new URLSearchParams;e.set("limit","500"),p.trim()&&e.set("action",p.trim()),m.trim()&&e.set("start",m.trim()),g.trim()&&e.set("end",g.trim());let t=await fetch(`/api/audit-logs/?${e.toString()}`,{credentials:"include"});if(!t.ok)throw Error(await t.text());let a=await w(t),r=e=>{let t=null==e?"":String(e);return t.includes('"')||t.includes(",")||t.includes("\n")?'"'+t.replace(/"/g,'""')+'"':t},s=a.map(e=>[e.id,e.actor_user_id,e.action,e.target_type,e.target_id,e.note??"",e.created_at??""]),i=["id,actor_user_id,action,target_type,target_id,note,created_at",...s.map(e=>e.map(r).join(","))].join("\n"),n=new Blob([i],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(n),o=document.createElement("a");o.href=l,o.download=`audit_logs_${Date.now()}.csv`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(l)}catch(e){u(e.message||"Export error")}finally{j(!1)}},children:b?"Đang xuất...":"Xuất CSV"})]}),a&&r.jsx("div",{className:"text-red-600 text-sm",children:a}),r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)(d.iA,{children:[r.jsx(d.xD,{children:(0,r.jsxs)(d.SC,{children:[r.jsx(d.ss,{children:"ID"}),r.jsx(d.ss,{children:"Người thực hiện"}),r.jsx(d.ss,{children:"H\xe0nh động"}),r.jsx(d.ss,{children:"Đối tượng"}),r.jsx(d.ss,{children:"Ghi ch\xfa"}),r.jsx(d.ss,{children:"Thời gian"})]})}),(0,r.jsxs)(d.RM,{children:[v&&r.jsx(d.SC,{children:r.jsx(d.pj,{colSpan:6,children:(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(o.O,{className:"h-4 w-full"}),r.jsx(o.O,{className:"h-4 w-3/4"}),r.jsx(o.O,{className:"h-4 w-1/2"})]})})}),0===e.length&&!v&&r.jsx(d.SC,{children:r.jsx(d.pj,{colSpan:6,className:"text-center text-gray-500",children:"Kh\xf4ng c\xf3 log n\xe0o."})}),e.map(e=>(0,r.jsxs)(d.SC,{children:[(0,r.jsxs)(d.pj,{className:"font-medium",children:["#",e.id]}),(0,r.jsxs)(d.pj,{children:["User #",e.actor_user_id]}),r.jsx(d.pj,{children:r.jsx(i.C,{variant:c[e.action]?.variant||"secondary",children:c[e.action]?.label||e.action})}),(0,r.jsxs)(d.pj,{children:[e.target_type,"#",e.target_id]}),r.jsx(d.pj,{className:"max-w-xs truncate",title:e.note||"",children:e.note||"-"}),r.jsx(d.pj,{children:e.created_at?new Date(e.created_at).toLocaleString("vi-VN"):"-"})]},e.id))]})]})})]})}},4432:(e,t,a)=>{"use strict";a.d(t,{I:()=>n});var r=a(326),s=a(7577),i=a(7863);let n=s.forwardRef(({className:e,type:t,...a},s)=>r.jsx("input",{type:t,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...a}));n.displayName="Input"},5304:(e,t,a)=>{"use strict";a.d(t,{O:()=>i});var r=a(326),s=a(7863);function i({className:e,...t}){return r.jsx("div",{className:(0,s.cn)("animate-pulse rounded-md bg-primary/10",e),...t})}},5940:(e,t,a)=>{"use strict";a.d(t,{RM:()=>o,SC:()=>d,iA:()=>n,pj:()=>u,ss:()=>c,xD:()=>l});var r=a(326),s=a(7577),i=a(7863);let n=s.forwardRef(({className:e,...t},a)=>r.jsx("div",{className:"relative w-full overflow-auto",children:r.jsx("table",{ref:a,className:(0,i.cn)("w-full caption-bottom text-sm",e),...t})}));n.displayName="Table";let l=s.forwardRef(({className:e,...t},a)=>r.jsx("thead",{ref:a,className:(0,i.cn)("[&_tr]:border-b",e),...t}));l.displayName="TableHeader";let o=s.forwardRef(({className:e,...t},a)=>r.jsx("tbody",{ref:a,className:(0,i.cn)("[&_tr:last-child]:border-0",e),...t}));o.displayName="TableBody",s.forwardRef(({className:e,...t},a)=>r.jsx("tfoot",{ref:a,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t})).displayName="TableFooter";let d=s.forwardRef(({className:e,...t},a)=>r.jsx("tr",{ref:a,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));d.displayName="TableRow";let c=s.forwardRef(({className:e,...t},a)=>r.jsx("th",{ref:a,className:(0,i.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));c.displayName="TableHead";let u=s.forwardRef(({className:e,...t},a)=>r.jsx("td",{ref:a,className:(0,i.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t}));u.displayName="TableCell",s.forwardRef(({className:e,...t},a)=>r.jsx("caption",{ref:a,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption"},9465:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>l});var r=a(8570);let s=(0,r.createProxy)(String.raw`D:\Workspace\beesmart\autoseo\dashboard\app\audit-logs\page.tsx`),{__esModule:i,$$typeof:n}=s;s.default;let l=(0,r.createProxy)(String.raw`D:\Workspace\beesmart\autoseo\dashboard\app\audit-logs\page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[948,393,708],()=>a(5575));module.exports=r})();