(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{4479:function(t,e,n){Promise.resolve().then(n.bind(n,2095))},2095:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return a}});var i=n(7437);let r=n(357).env.NEXT_PUBLIC_API_PREFIX||"/api";async function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=localStorage.getItem("token"),i={"Content-Type":"application/json; charset=utf-8",...e.headers};n&&(i.Authorization="Bearer ".concat(n));let s=await fetch("".concat(r).concat(t),{...e,headers:i});if(!s.ok)throw Error(await s.text()||"Request failed: ".concat(s.status));return(s.headers.get("content-type")||"").includes("application/json")?await s.json():await s.text()}var o=n(6463),u=n(2265);function a(){let t=(0,o.useRouter)(),[e,n]=(0,u.useState)([]),[r,a]=(0,u.useState)({site_id:1,title:"",body:"",status:"pending"}),[l,c]=(0,u.useState)(null),[d,h]=(0,u.useState)(null),[f,p]=(0,u.useState)(null),[y,g]=(0,u.useState)(!1);async function m(){try{let t=await s("/content/");n(t)}catch(t){c(t.message)}}async function v(t){t.preventDefault(),c(null),h(null);try{await s("/content/",{method:"POST",body:JSON.stringify(r)}),await m(),a({site_id:1,title:"",body:"",status:"pending"})}catch(t){c(t.message)}}async function b(t){c(null),h(null);try{g(!0);let e=await s("/content/checklist",{method:"POST",body:JSON.stringify({title:t.title,body:t.body||""})});if(p(e),g(!1),!e.passed){h(null);return}let n=await s("/content/publish",{method:"POST",body:JSON.stringify({site_id:t.site_id,title:t.title,body:t.body||"",status:"draft"})});n.ok&&n.link?h("Published: ".concat(n.link)):h("Published (no link returned).")}catch(t){c(t.message)}finally{g(!1)}}return(0,u.useEffect)(()=>{m()},[t]),(0,i.jsxs)("main",{style:{padding:16,fontFamily:"sans-serif"},children:[(0,i.jsx)("h1",{children:"Content"}),(0,i.jsxs)("form",{onSubmit:v,style:{display:"grid",gap:8,maxWidth:600},children:[(0,i.jsx)("input",{type:"number",placeholder:"Site ID",value:r.site_id,onChange:t=>a({...r,site_id:Number(t.target.value)})}),(0,i.jsx)("input",{placeholder:"Title",value:r.title,onChange:t=>a({...r,title:t.target.value})}),(0,i.jsx)("input",{placeholder:"Body",value:r.body||"",onChange:t=>a({...r,body:t.target.value})}),(0,i.jsx)("button",{type:"submit",children:"Create"}),l&&(0,i.jsx)("p",{style:{color:"red"},children:l})]}),(0,i.jsx)("h2",{style:{marginTop:24},children:"List"}),d&&(0,i.jsx)("p",{style:{color:"green"},children:d}),f&&(0,i.jsxs)("div",{style:{border:"1px solid #ddd",padding:8,marginBottom:12},children:[(0,i.jsx)("strong",{children:"Checklist:"})," ",f.passed?"Passed":"Failed"," (score"," ",f.score,")",f.issues.length>0&&(0,i.jsxs)("div",{style:{color:"red"},children:["Issues: ",f.issues.join(", ")]}),f.warnings.length>0&&(0,i.jsxs)("div",{style:{color:"#a60"},children:["Warnings: ",f.warnings.join(", ")]})]}),(0,i.jsx)("ul",{children:e.map((t,e)=>(0,i.jsx)("li",{style:{marginBottom:8},children:(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{children:["[",t.site_id,"] ",t.title," â€“ ",t.status||"pending"]}),(0,i.jsx)("button",{disabled:y,onClick:()=>b(t),children:y?"Checking...":"Publish to WP"})]})},e))})]})}},6463:function(t,e,n){"use strict";var i=n(1169);n.o(i,"usePathname")&&n.d(e,{usePathname:function(){return i.usePathname}}),n.o(i,"useRouter")&&n.d(e,{useRouter:function(){return i.useRouter}})},357:function(t,e,n){"use strict";var i,r;t.exports=(null==(i=n.g.process)?void 0:i.env)&&"object"==typeof(null==(r=n.g.process)?void 0:r.env)?n.g.process:n(8081)},8081:function(t){!function(){var e={229:function(t){var e,n,i,r=t.exports={};function s(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function u(t){if(e===setTimeout)return setTimeout(t,0);if((e===s||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:s}catch(t){e=s}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var a=[],l=!1,c=-1;function d(){l&&i&&(l=!1,i.length?a=i.concat(a):c=-1,a.length&&h())}function h(){if(!l){var t=u(d);l=!0;for(var e=a.length;e;){for(i=a,a=[];++c<e;)i&&i[c].run();c=-1,e=a.length}i=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function p(){}r.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new f(t,e)),1!==a.length||l||u(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(t){return[]},r.binding=function(t){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},n={};function i(t){var r=n[t];if(void 0!==r)return r.exports;var s=n[t]={exports:{}},o=!0;try{e[t](s,s.exports,i),o=!1}finally{o&&delete n[t]}return s.exports}i.ab="//";var r=i(229);t.exports=r}()}},function(t){t.O(0,[971,23,744],function(){return t(t.s=4479)}),_N_E=t.O()}]);